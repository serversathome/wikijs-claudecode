doctype html
html(lang=siteConfig.lang)
  head
    meta(http-equiv='X-UA-Compatible', content='IE=edge')
    meta(charset='UTF-8')
    meta(name='viewport', content='user-scalable=yes, width=device-width, initial-scale=1, maximum-scale=5')
    meta(name='theme-color', content='#1976d2')
    meta(name='msapplication-TileColor', content='#1976d2')
    meta(name='msapplication-TileImage', content='/_assets/favicons/mstile-150x150.png')

    title= pageMeta.title + ' | ' + config.title

    //- SEO / OpenGraph
    meta(name='description', content=pageMeta.description)
    meta(property='og:title', content=pageMeta.title)
    meta(property='og:type', content='website')
    meta(property='og:description', content=pageMeta.description)
    meta(property='og:image', content=pageMeta.image)
    meta(property='og:url', content=pageMeta.url)
    meta(property='og:site_name', content=config.title)

    //- Favicon - This section was modified by Claude Code to use site logo as favicon
    //- Only use custom logo if it's set and not the default Wiki.js butterfly
    - var useCustomFavicon = siteConfig.logoUrl && !siteConfig.logoUrl.includes('wikijs-butterfly')
    if useCustomFavicon
      link(rel='apple-touch-icon', sizes='180x180', href=siteConfig.logoUrl)
      link(rel='icon', type='image/png', sizes='192x192', href=siteConfig.logoUrl)
      link(rel='icon', type='image/png', sizes='32x32', href=siteConfig.logoUrl)
      link(rel='icon', type='image/png', sizes='16x16', href=siteConfig.logoUrl)
      link(rel='shortcut icon', href=siteConfig.logoUrl)
    else
      link(rel='apple-touch-icon', sizes='180x180', href='/_assets/favicons/apple-touch-icon.png')
      link(rel='icon', type='image/png', sizes='192x192', href='/_assets/favicons/android-chrome-192x192.png')
      link(rel='icon', type='image/png', sizes='32x32', href='/_assets/favicons/favicon-32x32.png')
      link(rel='icon', type='image/png', sizes='16x16', href='/_assets/favicons/favicon-16x16.png')
    link(rel='mask-icon', href='/_assets/favicons/safari-pinned-tab.svg', color='#1976d2')
    link(rel='manifest', href='/_assets/manifest.json')

    //- Site Properties
    script.
      var siteConfig = !{JSON.stringify(siteConfig)}
      var siteLangs = !{JSON.stringify(langs)}

    //- Dev Mode Warning
    if devMode
      script.
        siteConfig.devMode = true

    //- Icon Set
    if config.theming.iconset === 'fa'
      link(
        type='text/css'
        rel='stylesheet'
        href='https://use.fontawesome.com/releases/v5.10.0/css/all.css'
        )
    else if config.theming.iconset === 'fa4'
      link(
        type='text/css'
        rel='stylesheet'
        href='https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css'
        )

    //- CSS
    <% for (var index in htmlWebpackPlugin.files.css) { %>
      <% if (htmlWebpackPlugin.files.cssIntegrity) { %>
    link(
      type='text/css'
      rel='stylesheet'
      href='<%= htmlWebpackPlugin.files.css[index] %>'
      integrity=config.security.securitySRI ? '<%= htmlWebpackPlugin.files.cssIntegrity[index] %>' : false
      crossorigin='<%= webpackConfig.output.crossOriginLoading %>'
    )
      <% } else { %>
    link(
      type='text/css'
      rel='stylesheet'
      href='<%= htmlWebpackPlugin.files.css[index] %>'
    )
      <% } %>
    <% } %>

    //- JS
    <% for (var index in htmlWebpackPlugin.files.js) { %>
      <% if (htmlWebpackPlugin.files.jsIntegrity) { %>
    script(
      type='text/javascript'
      src='<%= htmlWebpackPlugin.files.js[index] %>'
      integrity=config.security.securitySRI ? '<%= htmlWebpackPlugin.files.jsIntegrity[index] %>' : false
      crossorigin='<%= webpackConfig.output.crossOriginLoading %>'
      )
      <% } else { %>
    script(
      type='text/javascript'
      src='<%= htmlWebpackPlugin.files.js[index] %>'
      )
      <% } %>
    <% } %>

    != analyticsCode.head

    block head

  body
    != analyticsCode.bodyStart
    block body
    != analyticsCode.bodyEnd

    //- Built-in Video Embed Support (YouTube, Vimeo, Dailymotion, Screencast, MP4)
    style.
      .responsive-embed {
        position: relative;
        padding-bottom: 56.25%;
        height: 0;
        overflow: hidden;
        max-width: 100%;
        margin: 1rem 0;
      }
      .responsive-embed iframe,
      .responsive-embed video {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }
    script.
      (function() {
        const rxYoutube = /^.*(?:(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|shorts\/|watch\?v=|watch\?.+&v=)))([^#&?]*).*/;
        const rxVimeo = /vimeo\.com\/(?:channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|album\/(?:\d+)\/video\/|)(\d+)(?:$|\/|\?)/;
        const rxDailymotion = /(?:dailymotion\.com(?:\/embed)?(?:\/video|\/hub)|dai\.ly)\/([0-9a-z]+)(?:[-_0-9a-zA-Z]+(?:#video=)?([a-z0-9]+)?)?/;
        const rxScreencast = /^.*(?:(?:https?:)?\/\/)?(?:www\.)?screencast\.com\/users\/([a-z0-9_-]+)\/folders\/([a-z0-9%_-]+)\/media\/([a-z0-9_-]+)(?:\/)?$/i;

        function convertVideoEmbeds() {
          document.querySelectorAll('.contents oembed, .contents figure.media oembed, .contents a, .contents p').forEach(function(elm) {
            var url = elm.hasAttribute('url') ? elm.getAttribute('url') : (elm.hasAttribute('href') ? elm.getAttribute('href') : elm.textContent.trim());
            if (!url) return;

            var newElmHtml = null;
            var ytMatch = url.match(rxYoutube);
            var vimeoMatch = url.match(rxVimeo);
            var dmMatch = url.match(rxDailymotion);
            var scMatch = url.match(rxScreencast);

            if (ytMatch && ytMatch[1]) {
              newElmHtml = '<iframe src="https://www.youtube-nocookie.com/embed/' + ytMatch[1] + '" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>';
            } else if (vimeoMatch && vimeoMatch[1]) {
              newElmHtml = '<iframe src="https://player.vimeo.com/video/' + vimeoMatch[1] + '" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>';
            } else if (dmMatch && dmMatch[1]) {
              newElmHtml = '<iframe src="https://www.dailymotion.com/embed/video/' + dmMatch[1] + '" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>';
            } else if (scMatch) {
              newElmHtml = '<iframe src="' + url + '/embed" frameborder="0" allowfullscreen></iframe>';
            } else if (url.match(/\.(mp4|webm|ogg)$/i)) {
              var type = url.endsWith('.mp4') ? 'video/mp4' : (url.endsWith('.webm') ? 'video/webm' : 'video/ogg');
              newElmHtml = '<video controls><source src="' + url + '" type="' + type + '">Your browser does not support the video tag.</video>';
            } else {
              return;
            }

            // For paragraphs, only convert if it contains just the URL
            if (elm.tagName === 'P') {
              if (elm.textContent.trim() !== url || elm.children.length > 0) return;
            }

            // For links, only convert standalone video links
            if (elm.tagName === 'A') {
              var linkText = elm.textContent.trim();
              if (linkText !== url && !linkText.includes('youtu') && !linkText.includes('vimeo')) return;
            }

            var newElm = document.createElement('div');
            newElm.className = 'responsive-embed';
            newElm.innerHTML = newElmHtml;
            elm.replaceWith(newElm);
          });
        }

        if (window.boot && window.boot.register) {
          window.boot.register('vue', function() {
            window.addEventListener('load', convertVideoEmbeds);
          });
        } else {
          document.addEventListener('DOMContentLoaded', convertVideoEmbeds);
        }
      })();
